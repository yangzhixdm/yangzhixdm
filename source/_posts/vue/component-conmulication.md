---
title: 组件通信
date: 2018-09-06 12:08:30
tags: Vue
description: 关于组件通信之间的一些思考，以及为什么要如此设计
---


#### 组件通信

##### 父子组件通信
在vue和react 的mvvm 组件化开发中，父子组件间的通信都同时采用了单向数据流动的方式，不允许子组件直接修改父组件传递下来的props属性的值。
1 单一职权原则，同一个数据尤其是共享的数据，不应该有多处可以进行修改，而是应该修改修改的位置统一在一个位置，这样可以保证数据更好的可控。而这一点也是mvvvm框架所强调的。相当初的jquery事件方案，同一个dom或者一个全局变量，随意一个位置可以触发一个事件，从而修改数据，久而久之系统在运行中，根本就无法知道数据是在哪个位置被修改。

2 谁生产，谁维护，谁产生的这个数据，那么这个数据就谁来维护。父组件中定义的数据，就应该是自己来维护，子组件只需要有读取的权限就可以了，因为这个数据本身就不属于子组件。子组件去修改父组件的值，本身设计就不合理。

##### 兄弟组件通信
和上面一样，我们依旧需要保证数据的一致性。

那么既然是兄弟组件，那么首先考虑的就是把数据给到父组件，兄弟之间都不去操控，让父组件去统一操作。但是这种方式有它存在的问题，就是如果两个兄弟之间层级很深，或者说是兄弟与孙子的关系，那么需要嵌套的关系就更加复杂。

我们还是要保证数据操作的单一性，那么可以考虑拿一个单独的组件出来，我们所有需要共享的数据都由它去生产。子组件需要修改数据时，触发该组件的方法即可。这种方法称为事件总线。不过他的问题是需要单独维护一个组件来处理共享的数据。其实它就是vuex的前身。

vuex或者redux 使用一个单独的区域来存放需要共享处理的变量， 每次数据存在修改，出发dispatch，匹配相应的动作，然后更新数据。

> 其实都是为了解决数据的单一修改职权问题。