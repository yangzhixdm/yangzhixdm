---
title: 关于https的几个问题
date: 2018-08-31 09:13:00
tags: http
description: https 在请求的过程中，需要了解的一些细节问题。
---

##### 加密与认证的区别？ 双向都是安全的么？
加密是将数据资料加密，使得非法用户即使取得加密过的资料，也无法获取正确的资料内容，所以数据加密可以保护数据，防止监听攻击。其重点在于数据的安全性。

身份认证是用来判断某个身份的真实性，确认身份后，系统才可以依不同的身份给予不同的权限。其重点在于用户的真实性。两者的侧重点是不同的。

加密是对https传输过程中的数据进行加密，保证其不可随意读取。
而认证则是客户端需要判断其连接的服务器是否为真实的服务器，而非中间人代理。

##### 为什么需要对称秘钥？
可以使用对称秘钥将数据进行加解密。从而保证非法用户无法读取，真实用户可以读取。

##### 为什么对需要非对称秘钥？
但是由于在互联网上直接传递对称秘钥，容易被劫取。故需要考虑如何将对称秘钥传递给客户端。
服务端生成特定的非对称秘钥，并将公钥下发给客户端。客户端使用公钥对数据进行解密，如果可以正常解密成功，如果中间没有中间人攻击的话，那么就证明连接的服务器为真实的服务器。

##### 什么又是中间人攻击？
请求中第三方劫取请求，将真实服务器的公钥替换为自己的公钥发给客户端，对于客户端而言，是无感知的。
{% asset_image man-in-middle-http-request.png %}

##### 数字证书的意义是什么？
试想如果需要在互联网上进行传递公钥的话，那么就一定会存在中间人的问题。那么如何解决呢？
考虑引入一个大家都任何的第三方认证机构，将真实服务器的公钥使用认证机构的私钥匙进行加密存储为数字证书，然后浏览器厂商在浏览器中默认存储着通用的三方机构的公钥。
这样浏览器在请求之前会获取服务器的证书，然后通过本地的公钥进行解密，如果能够成功解开，就证明是在三方机构认证过的服务器。那么如果没有认证过的中间人想进行冒充的话，由于无过没有三方机构的公钥，就无法获得服务器真正的私钥，且即使中间人进行自己证书，客户端使用三方的公钥解密失败，无法达到欺骗的目的。
那么接下来的问题来了，三方机构多个服务器进行认证，如果一个被认证过的机构进行中间人冒充的话，怎么进行识别呢？

##### 数字签名又是什么？
考虑上面的问题，如果一个被认证过的机构进行中间人冒充的话，怎么进行识别呢？
那么就需要保证三方认证机构发给每个服务器带有各自的标记，用来表示自己的身份。而这个标记就是所谓的签名。
认证机构会将服务器的信息采用算法（md5或者sha1）生成一个hash值，然后使用私钥进行加密以证书的方式发放给服务器。页这个hash值就是所谓的签名。客户端使用证书提供的公钥进行解密之后，会对服务器的信息进行一样的算法加密，如果得到的hash值与解密出来的值一致，则证明服务器是可信的。